# Index
* Create an AI Tool
    * [Mock Example](#mock-example)
    * [Real Example](#real-example)

# Create an AI Tool
## Mock Example
Let's start with a mock example. In this example, we are creating a simple AI Tool for querying Jira. When the tool is called, simply print the JQL query generated by OpenAI instead of making Jira API call.

```python
%python%

from typing import List
from webcli2.core.ai import Task, AgenticMixin, Tool, Message, MessageRole
from pydantic import BaseModel, Field, ConfigDict

# Step 1: define tool, and it's input type
class JQLInput(BaseModel):
    jql_query: str = Field(..., description="The JQL Query String") # Make the description easy to understand by LLM
    model_config = ConfigDict(extra='forbid')

class MockJiraTool(Tool):
    def run(self, input:JQLInput):
        print(f"running query: {input.jql_query}")

# Step 2: define AI Agent
#         during __init__, create a tool, register it
#         implement method run, call ask_llm provided by AgenticMixin
class JiraAgent(Task, AgenticMixin):
    def __init__(self):
        super().__init__(name="Jira Agent", description="Jira Agent", requires=["question"])
        jira_tool = MockJiraTool(name="run_jql_query", description="Execute JQL Query", input_type=JQLInput)
        self.add_tool(jira_tool) # register the necessary tool

    def run(self):
        self.ask_llm([Message(role=MessageRole.USER, content=self.get_variable("question"))])

# Step 3: instantiate AI Agent, provide variable it requires, and run it 
jira_agent = JiraAgent()
question = """
Can you generate a JQL query, the query need to return all JIRA ticket for project HWD, and assignee is shizhong, let's sort the result by created field, with most recent created on top. Use the provided tool to fetch data.
"""
jira_agent.set_variable("question", question)
r = jira_agent.run()
```

## Real Example
Now let's run a real example, instead of mocking the JQL query, we are going to execute the JQL query.

```python
%python%

from typing import List
from webcli2.core.ai import Task, AgenticMixin, Tool, Message, MessageRole
from pydantic import BaseModel, Field, ConfigDict
from webcli2.core.ai.libs.oracle import OracleTools

# Step 1: define tool, and it's input type
class JQLInput(BaseModel):
    jql_query: str = Field(..., description="The JQL Query String") # Make the description easy to understand by LLM
    model_config = ConfigDict(extra='forbid')

class JiraTool(Tool):
    def run(self, input:JQLInput):
        oracle_tools = OracleTools()
        jira_issues = oracle_tools.jira_execute_jql(input.jql_query)
        for jira_issue in jira_issues:
            print(f"{jira_issue.key} -- {jira_issue.fields.summary}")

# Step 2: define AI Agent
#         during __init__, create a tool, register it
#         implement method run, call ask_llm provided by AgenticMixin
class JiraAgent(Task, AgenticMixin):
    def __init__(self):
        super().__init__(name="Jira Agent", description="Jira Agent", requires=["question"])
        jira_tool = JiraTool(name="run_jql_query", description="Execute JQL Query", input_type=JQLInput)
        self.add_tool(jira_tool) # register the necessary tool

    def run(self):
        self.ask_llm([Message(role=MessageRole.USER, content=self.get_variable("question"))])

# Step 3: instantiate AI Agent, provide variable it requires, and run it 
jira_agent = JiraAgent()
question = """
Can you generate a JQL query, the query need to return all JIRA ticket for project HWD, and assignee is shizhong, let's sort the result by created field, with most recent created on top. Use the provided tool to fetch data.
"""
jira_agent.set_variable("question", question)
r = jira_agent.run()
```

Here is the screenshot when you run this AI Agent:
![Screenshot](ai-agent-01.png "Screenshot")

